
![](https://img.shields.io/github/actions/workflow/status/moonlightmoth/neoflexskillassessment/test-workflow.yml)

# NeoflexSkillAssessment

Этот репозиторий содержит выполненное тестовое задание для центра Neostudy. 

README доступен на английском языке [здесь](https://github.com/moonlightMoth/NeoflexSkillAssessment/blob/main/README.md)

<details> 
<summary><h3>Содержание<h3></summary>
 <ol> 
 <li>
 <a href="#общая-информация">Общая информация</a></li> <li> <a href="#сборка-и-выполнение">Сборка и выполнение</a> <ul> <li><a href="#средства-сборки">Средства сборки</a></li> <li> <a href="#сборка">Сборка</a></li> <li><a href="#выполнение">Выполнение</a></li> </ul> </li> <li> <a href="#реализация-запросов">Реализация запросов</a> <ul> <li><a href="#порты-и-конечные-точки">Порты и конечные точки</a></li> <li><a href="#краткая-форма-запроса">Краткая форма запроса</a></li> <li><a href="#полная-форма-запроса">Полная форма запроса</a></li> <li><a href="#неверный-запрос">Неверный запрос</a></li> </ul> </li> <li><a href="#контакты">Контакты</a></li> </ol> </details>


## Общая информация

В соответствии с задачей был реализован микросервис Spring Boot, который имеет одну GET конечную точку `/calculate` [^1].
Вкратце, приложение принимает запрос `GET /calculate` с **query** параметрами, содержащими сумму заработной платы за последние 365 дней и продолжительность отпуска в разных формах, и возвращает полную сумму оплаты отпуска за этот период. Формы запросов и параметры запроса описаны в разделе [Реализация запроса](#реализация-запроса).
Приложение использует Spring Boot в качестве веб-фреймворка, Maven в качестве системы сборки, JUnit и Spring Boot тестирование.
Дополнительно были реализованы файл рабочего процесса GitHub Actions для тестов сборки и Dockerfile.

[^1]: В задаче описано `GET "/calculacte"`, но я предположил, что имелось в виду `/calculate`


## Сборка и выполнение
### Средства сборки
* Java 11 (Разработано на Eclipse Temurin)
* Maven или Docker

### Сборка
Есть два метода сборки из исходников:
1. Используя Maven
2. Используя Docker
#### Maven
```
git clone https://github.com/moonlightmoth/neoflexskillassessment
cd neoflexskillassessment
mvn clean compile install spring-boot:repackage
```
Исполняемый jar `neoflexskillassessment-<version>.jar` будет в директории `target/`.

#### Docker
```
git clone https://github.com/moonlightmoth/neoflexskillassessment
cd neoflexskillassessment
docker build . --tag <your_tag>
```

### Выполнение

#### Maven
```
java -jar target/neoflexskillassessment-<version>.jar
```

#### Docker
```
docker run -d -p <any_port>:8080 <your_tag>
```

## Реализация запроса

### Порты и конечные точки
При запуске приложение слушает http-порт 8080 и принимает запросы к конечной точке `/calculate`. Запрос **должен** предоставлять **query** параметры в одной из двух форм: [краткой](#короткая-форма-запроса) или [полной](#полная-форма-запроса) формах.

### Краткая форма запроса


Запрос в краткой форме **должен** содержать параметры запроса: 
 * `avgSalary` double, представляющий сумму зарплаты за последние 365 дней 
 * `vacationLength` integer, представляющий количество дней отпуска 

Этот тип запроса предполагает, что все указанные дни оплачиваются, поэтому используется следующая формула: $$ leavePayment = \frac{avgSalary}{365} * vacationDays $$ Обратите внимание, что центы всегда округляются в пользу сотрудника. 

Пример запроса в краткой форме на localhost:
```
http://localhost:8080/calculate?avgSalary=36500&vacationLength=1
``` 
Ответом на этот запрос должно быть 100.00.

### Полная форма запроса


Запрос полной формы **должен** содержать параметры запроса: 
  * `avgSalary` представляет собой сумму зарплаты за последние 365 дней 
  * `fromDate` в формате `dd.MM.yy` представляет собой дату начала отпуска 
  * `dueToDate` в формате `dd.MM.yy` представляет собой последний день отпуска 

`fromDate` **должен** быть меньше или равен `dueToDate`, оба **должны** быть **только** в формате `dd.MM.yy`. Этот тип запроса возвращает отпускные, предполагая, что выходные и государственные праздники не оплачиваются. Информация о праздниках предоставляется во время сборки через файл `src/main/resources/holidays` в формате `dd.MM.yy\n` для каждого праздника. [^2] 

Пример запроса полной формы на localhost:
```
http://localhost:8080/calculate?avgSalary=36500&fromDate=01.01.24&dueToDate=12.01.24
``` 
Ответом на этот запрос должно быть 400.00 при стандартной конфигурации праздников

[^2]: С моей точки зрения, этот подход предоставления праздничных дат далеко не самый лучший, но я предполагаю, что не могу полагаться на внешние ресурсы для получения праздников в этом задании. Лучше было бы иметь отдельный сервис, который будет выдавать праздники на текущий год со своей поддержкой и обновлениями, но это выходит за рамки текущего задания.

### Неверный запрос

Любой запрос, который не соответствует шаблонам полной или краткой формы, считается неверным и не обрабатывается. При неверном вводе параметров конечная точка `/calculate` дает небольшую подсказку о правильном формате параметров, но другие конечные точки возвращают сообщение `404`.


## Контакты

Не стесняйтесь связаться со мной через [Telegram](https://t.me/moonlightmoth) (предпочтительнее) или vasilev.iv.dev@mail.ru.
